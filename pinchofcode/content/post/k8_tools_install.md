+++
title = 'Installation of some common tools in Onpremise Kubernetes 🏳'
date = 2024-03-13T11:23:42+05:30
draft = false
+++
# Installation of some common tools in Onpremise Kubernetes 🏳

In this guide, we'll walk through the process of installing tools like Helm, Metallb, Ingress Controller, Keycloak, Jenkins in  Kubernetes (Ubuntu).
<!--more-->
## Prerequisites
Before we begin, ensure that you have the following prerequisites:

1. Kubenetes Installed and Configured

## Helm Installation Steps
```shell
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod 700 get_helm.sh
./get_helm.sh
```
## Ingress Controller Installation Steps

This will make ingress controller up in ingress-nginx namespace.

```shell
helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
helm search repo ingress-nginx --versions
helm repo update

helm template ingress-nginx ingress-nginx --repo https://kubernetes.github.io/ingress-nginx --namespace ingress-nginx > /home/xyzcorp/ingress/ingress-nginx.yaml

kubectl apply -f  ingress-nginx.yaml -n ingress-nginx
```
## MetalLB Installation Steps

This will make ingress controller up in metallb-system namespace.
```shell
kubectl create ns metallb-system
helm repo add metallb https://metallb.github.io/metallb	
helm upgrade --install -n metallb-system metallb oci://registry-1.docker.io/bitnamicharts/metallb
	or
helm install metallb -n metallb-system metallb/metallb
```		
Once metallb-system system is up, change range allocation using 
L2-range-allocation.yaml and do 
```shell
kubectl apply -f L2-range-allocation.yaml
```
Sample [Range Allocation yaml](https://krishnakalesh.github.io/pinchofcode/data/L2-range-allocation.yaml)
## How to make iptable changes when required 
```shell
sudo iptables-save > iptable.txt 
#Uncomment or add the following line to the file: sudo nano /etc/sysctl.conf
#Example - net.ipv4.ip_forward=1
#Example - sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 8086 -j DNAT --to-destination xxx.xxx.x.x:8086
#Example - sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to-destination xxx.xxx.x.x:80
```
## How to make create a TLS secret 
This TLS secret can be used in ingress settings to apply certificates of your domains
```shell
kubectl create secret tls xyzcorp-tls --namespace develop --key=xyzcorp.key --cert=xyzcorp-crt.crt -o yaml		
```	
## How to install Keycloak Software 
```shell
helm install keycloak -f keycloak-values.yaml bitnami/keycloak -n develop
```	
Sample  [Keycloak Installation yaml](https://krishnakalesh.github.io/pinchofcode/data/keycloak-values.yaml)
## How to install Jenkins Software 
```shell
helm install jenkins -n devops-tools -f jenkins_install.yaml jenkinsci/jenkins
```	
Sample [Jenkins Installation yaml](https://krishnakalesh.github.io/pinchofcode/data/jenkins_install.yaml) 
## Authenticate to the remote host using SSH key-based Authentication
```shell
ssh-keygen -t rsa --> This command generates a new SSH key pair using the RSA algorithm.
ssh-copy-id user1@XXX.XX.X.X --> This command copies the public SSH key generated by ssh-keygen to the specified remote host (XXX.XX.X.X) for the user user1
```	